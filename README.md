# Серверная часть комплекса "Система управления организациями"

 
## О сервере

Серверная часть системы управления организациями предоставляет программный интерфейс, необходимый для использования следующей функциональности:  

- создание организации;
- изменение организации;
- удаление организации (если у организации есть дочерние элементы, удалить ее нельзя);
- список организаций с количеством работающих в ней сотрудников (параметры: пагинация и поиск по наименованию);
- список организаций в древовидной форме (дерево выдаётся кусками);
- создание сотрудника (при выборе организации можно выбрать руководителя только из этой организации);
- изменение сотрудника (при выборе организации можно выбрать руководителя только из этой организации);
- удаление сотрудника (если у сотрудника есть дочерние элементы, удалить его нельзя);
- список сотрудников (в списке показывать еще его организацию и руководителя) с параметрами: пейджинг и поиск по наименованию организации и/или сотрудника;
- список сотрудников в древовидной форме с пейджингом на дочерние элементы.

## Описание программного интерфейса

Адреса всех точек доступа к программному интерфейсу начинается с /api, поэтому далее эта часть будет опущена при написании адреса.

### Программный интерфейс для работы с организациями

Доступ к функциональности предоставляется следующим образом:

- Для создания организации необходимо отправить на /organizations POST-запрос, в теле которого содержится объект JSON с полями `name` и `parent`, хранящих информацию о названии и головной организации у организации соответственно (`name` - не пустая строка, `parent` (если указан) - строка, корректно представляющая UUID существующей организации). Возвращаемые коды статуса HTTP: 201 (организация успешно создана), 406 (объект не удовлетворяет предъявленным к нему требованиям). В случае успеха возвращается JSON-объект с полем `data`, хранящим идентификатор новой организации.
- Для изменения организации необходимо отправить на /organizations PUT-запрос, в теле которого содержится объект JSON с полями `id`, `name` и `parent`, хранящих информацию об идентификаторе изменяемой организации, а также новых названии и головной организации для изменяемой организации соответственно (`id` - строка, корректно представляющая UUID, требования к двум другим полям такие же, как и в предыдущем случае). Возвращаемые коды статуса HTTP: 201 (организация успешно обновлена), 404 (изменяемая организация не найдена), 406 (объект не удовлетворяет предъявленным к нему требованиям).
- Для удаления организации необходимо отправить на /organizations DELETE-запрос с параметром `id` (`id` - строка, корректно представляющая UUID). Возвращаемые коды статуса HTTP: 200 (организация успешно удалена), 404 (организация не найдена), 406 (некорректный параметр), 422 (у организации ещё есть дочерние элементы - сотрудники или другие организации).
- Для получения списка организаций необходимо отправить на /organizations/list GET-запрос, который может содержать параметры `limit`, `offset`, `search`, где `limit` и `offset` - параметры пагинации, `search` - параметр для поиска по имени организации. В случае успеха возвращается JSON-объект, где в поле `data` хранится объект куска списка. Кусок списка в поле `totalCount` хранит общее число элементов, удовлетворяющих параметрам поиска, а в поле `dataChunk` - собственно элементы в куске списка.
- Для получения дерева организаций необходимо отправить на /organizations/tree GET-запрос, который может содержать параметр `id`, хранящий информацию об идентификаторе организации, дочерние элементы которой необходимо выдать (`id` - строка, корректно представляющая UUID). Если параметр `id` отсутствует, считается, что необходимо выдать список организаций, у которых нет головной организации. Возвращаемые коды статуса HTTP: 200 (список успешно сформирован), 404 (организация с идентификатором равным параметру `id` не найдена). В случае успеха выдаётся JSON-объект, где в поле `data` хранится список узлов дерева. В каждом узле хранится информация об организации, а также о том, есть ли у организации дочерние организации.
 
### Программный интерфейс для работы с сотрудниками

- Для создания сотрудника необходимо отправить на /employees POST-запрос, в теле которого содержится объект JSON с полями `name`, `chief` `organization`, хранящих информацию об имени сотрудника, а также его руководителе и головной организации (`name` - не пустая строка, `chief` и `organization` (если указаны) - строки, корректно представляющая UUID существующей организации). Возвращаемые коды статуса HTTP: 201 (организация успешно создана), 406 (объект не удовлетворяет предъявленным к нему требованиям). В случае успеха возвращается JSON-объект с полем `data`, хранящим идентификатор нового сотрудника.
- Для изменения организации необходимо отправить на /employees PUT-запрос, в теле которого содержится объект JSON с полями `id`, `name`,  `chief` `organization`, хранящих информацию об идентификаторе изменяемого сотрудника, а также новых имени, руководителе и организации для изменяемого сотрудника соответственно (`id` - строка, корректно представляющая UUID, требования к трём другим полям такие же, как и в предыдущем случае). Возвращаемые коды статуса HTTP: 201 (сотрудник успешно обновлён), 404 (изменяемый сотрудник не найден), 406 (объект не удовлетворяет предъявленным к нему требованиям).
- Для удаления сотрудника необходимо отправить на /employees DELETE-запрос с параметром `id` (`id` - строка, корректно представляющая UUID). Возвращаемые коды статуса HTTP: 200 (сотрудник успешно удалён), 404 (сотрудник не найден), 406 (некорректный параметр), 422 (у сотрудника ещё есть подчинённые).
- Для получения списка организаций необходимо отправить на /employees/list GET-запрос, который может содержать параметры `limit`, `offset`, `search`, `organization`, где `limit` и `offset` - параметры пагинации, `search` - параметр для поиска по имени сотрудника, `organization` - параметр для поиска по названию организации. В случае успеха возвращается JSON-объект, где в поле `data` хранится объект куска списка. Кусок списка в поле `totalCount` хранит общее число элементов, удовлетворяющих параметрам поиска, а в поле `dataChunk` - собственно элементы в куске списка.
- Для получения дерева организаций необходимо отправить на /employees/tree GET-запрос, который может содержать следующие параметры: `id` (хранящий информацию об идентификаторе сотрудника, подчинённых которого необходимо выдать), `limit` (хранящий информацию об ограничении на количество дочерних элементов), `offset` (хранящий информацию о сдвиге по дочерним элементам);`id` - строка, корректно представляющая UUID, `limit` и `offset` - неотрицательные числа. Если параметр `id` отсутствует, считается, что необходимо выдать список сотрудников, у которых нет руководителя. Возвращаемые коды статуса HTTP: 200 (список успешно сформирован), 404 (сотрудник с идентификатором равным параметру `id` не найден), 406 (неприемлемые значения параметров). В случае успеха выдаётся JSON-объект, где в поле `data` хранится список узлов дерева. В каждом узле хранится информация о сотруднике, а также о том, есть ли у сотрудника подчинённые.